<div class="container-fluid mt-4">
  <div class="row">
    <!-- Colonne gauche : Liste des projets -->
    <div class="col-md-4 border-end">
      <h5>Liste des projets en-cours</h5>
      <mat-nav-list>
        @for(projet of projets;track projet){
        <mat-list-item
          (click)="selectProjet(projet)"
          [class.active]="projet === projetSelectionne"
          style="cursor: pointer"
        >
          {{ projet.nom }}
        </mat-list-item>
        }
      </mat-nav-list>

      <div class="mt-3 d-flex flex-column gap-2">
        <button mat-raised-button color="primary" (click)="creerProjet()">
          Nouveau projet
        </button>
        <button
          mat-raised-button
          color="warn"
          (click)="effacerProjet()"
          [disabled]="!projetSelectionne"
        >
          Effacer projet
        </button>
        <button
          mat-raised-button
          color="accent"
          (click)="renommerProjet()"
          [disabled]="!projetSelectionne"
        >
          Renommer projet
        </button>
      </div>
    </div>

    <!-- Colonne droite : Propositions + Détails -->
    <div class="col-md-8">
      @if(projetSelectionne){
      <h5>Propositions du projet : {{ projetSelectionne?.nom }}</h5>
      }
      @if(projetSelectionne && projetSelectionne.propositions.length > 0){
      <mat-nav-list

      >
        @for(prop of projetSelectionne!.propositions;track prop){
        <mat-list-item
          (click)="selectProposition(prop)"
          [class.active]="prop === propositionSelectionnee"
          style="cursor: pointer"
        >
          {{ prop.intitule }}
        </mat-list-item>
        }
      </mat-nav-list>
    }
      @if(projetSelectionne){
      <div class="mt-3 d-flex flex-column gap-2">
        <button
          mat-raised-button
          color="primary"
          (click)="ajouterProposition()"
        >
          Nouvelle proposition
        </button>
        <button
          mat-raised-button
          color="warn"
          (click)="effacerProposition()"
          [disabled]="!propositionSelectionnee"
        >
          Effacer proposition
        </button>
      </div>
      } @if(propositionSelectionnee){
      <div class="mt-4">
        <h6>Détails proposition</h6>

        <mat-form-field class="w-100">
          <mat-label>Intitulé</mat-label>
          <input matInput [(ngModel)]="propositionSelectionnee!.intitule" />
        </mat-form-field>

        <mat-form-field class="w-100">
          <mat-label>Données administratives et techniques</mat-label>
          <textarea
            matInput
            rows="4"
            [(ngModel)]="propositionSelectionnee!.details"
          ></textarea>
        </mat-form-field>

        <mat-form-field class="w-100">
          <mat-label>Garanties, clauses</mat-label>
          <textarea
            matInput
            rows="3"
            [(ngModel)]="propositionSelectionnee!.garanties"
          ></textarea>
        </mat-form-field>

        <button
          mat-raised-button
          color="primary"
          (click)="validerProposition()"
        >
          Valider proposition
        </button>
      </div>
      }
    </div>
  </div>
</div>
